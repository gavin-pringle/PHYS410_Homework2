\documentclass[10pt]{article}

\usepackage[utf8]{inputenc}
\usepackage{latexsym,amsfonts,amssymb,amsthm,amsmath}
\setlength{\parindent}{0in}
\setlength{\parskip}{\baselineskip}
\setlength{\oddsidemargin}{0in}
\setlength{\textwidth}{6.5in}
\setlength{\textheight}{8.8in}
\setlength{\topmargin}{0in}
\setlength{\headheight}{18pt}

\usepackage[a4paper,margin=1in,footskip=0.25in]{geometry}

\usepackage{listings}
\usepackage{color} %red, green, blue, yellow, cyan, magenta, black, white
\definecolor{mygreen}{RGB}{28,172,0} % color values Red, Green, Blue
\definecolor{mylilas}{RGB}{170,55,241}

\usepackage{graphicx}
\graphicspath{{../output/}}

\def\code#1{\texttt{#1}} % Monospacing shortcut: Use \code{}

\usepackage[colorlinks=true, urlcolor=blue, linkcolor=blue]{hyperref}

\usepackage{verbatim} % For including raw text files in the pdf
\usepackage{float} % For keeping figures in the section where they were called 

\title{PHYS 410 Homework 2}
\author{Gavin Pringle, 56401938}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Start of document
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{document}

\maketitle

\lstset{language=Matlab,%
    %basicstyle=\color{red},
    breaklines=true,%
    morekeywords={matlab2tikz},
    keywordstyle=\color{blue},%
    morekeywords=[2]{1}, keywordstyle=[2]{\color{black}},
    identifierstyle=\color{black},%
    stringstyle=\color{mylilas},
    commentstyle=\color{mygreen},%
    showstringspaces=false,%without this there will be a symbol in the places where there is a space
    numbers=left,%
    numberstyle={\tiny \color{black}},% size of the numbers
    numbersep=9pt, % this defines how far the numbers are from the text
    emph=[1]{for,end,break},emphstyle=[1]\color{red}, %some words to emphasise
    %emph=[2]{word1,word2}, emphstyle=[2]{style},    
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Introduction
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection*{Introduction}

In this homework assignment, the fourth-order Runge-Kutta method for computing numerical solutions of 
ODEs is explored. This is done in stages, culminating in creating a MATLAB function that numerically
integrates an ODE using an algorithm that automatically varies the step size of the integrator in order
to achieve a relative error tolerance. 

First, a function \code{rk4step} is written that computes a single fourth-order Runge-Kutta step for a 
system of coupled first-order ODEs, returning the approximate values of the dependent variables after
a defined time step. The function \code{rk4step} is then used in the function \code{rk4} which computes 
the solution of an initial value problem over a range of values for the independent variable, done by 
taking multiple fourth-order Runge-Kutta steps in a loop. Lastly, the function \code{rk4ad} is written 
which finds the numerical solution of an initial value problem by comparing the results of fourth-order 
Runge-Kutta steps of different sizes and then varying the step size as until the error in the 
approximation is below a specified relative tolerance.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Review of Theory
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection*{Review of Theory}

\subsubsection*{Casting systems of ODEs in first-order form}



\subsubsection*{The fourth-order Runge-Kutta step}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Numerical approach
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection*{Numerical Approach}

\subsubsection*{Consecutive fourth-order Runge-Kutta steps}
% the code implementation of the fourth-order Runge-Kutta step is shown in Appendix A
% in order to solve an ODE initial value problem, multiple fourth-order Runge-Kutta steps must be taken 

% Refer to Appendix C 

\subsubsection*{Adaptive step sizing}

% Discuss how the error is checked by taking fine and coarse steps 
% Can copy lots of equations from the homework doc

% Describe my rk4ad algorithm 

% Refer to Appendix F 


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Implementation
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection*{Implementation}

\subsubsection*{ODE test functions} % sho and vdp
% In order to test ... 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Results
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection*{Results}

\subsubsection*{rk4step.m Output}

\subsubsection*{rk4.m Output}

\subsubsection*{rk4ad.m Output}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Conclusions
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection*{Conclusions}


\pagebreak

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Appendices
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\subsection*{Appendix A - rk4step.m Code}
\lstinputlisting{../src/rk4step.m}
\pagebreak

\subsection*{Appendix B - trk4step.m Code}
\lstinputlisting{../src/trk4step.m}
\pagebreak

\subsection*{Appendix C - rk4.m Code}
\lstinputlisting{../src/rk4.m}
\pagebreak

\subsection*{Appendix D - trk4\_sho.m Code}
\lstinputlisting{../src/trk4_sho.m}
\pagebreak

\subsection*{Appendix E - trk4\_vdp.m Code}
\lstinputlisting{../src/trk4_vdp.m}
\pagebreak

\subsection*{Appendix F - rk4ad.m Code}
\lstinputlisting{../src/rk4ad.m}
\pagebreak

\subsection*{Appendix G - trk4ad\_sho.m Code}
\lstinputlisting{../src/trk4ad\_sho.m}
\pagebreak

\subsection*{Appendix H - trk4ad\_vdp.m Code}
\lstinputlisting{../src/trk4ad\_vdp.m}
\pagebreak

\end{document}